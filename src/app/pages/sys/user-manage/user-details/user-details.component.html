<app-section dkTitle="用户基本信息" [dkExtra]="back">
  <nz-descriptions nzBordered style="margin-bottom: 24px">
    <nz-descriptions-item nzTitle="用户名">Zhou Maomao</nz-descriptions-item>
    <nz-descriptions-item nzTitle="姓名">Zhou Maomao</nz-descriptions-item>
    <nz-descriptions-item nzTitle="手机号">18100000000</nz-descriptions-item>
    <nz-descriptions-item nzTitle="状态">Hangzhou, Zhejiang</nz-descriptions-item>
    <nz-descriptions-item nzTitle="部门">总经办</nz-descriptions-item>
    <nz-descriptions-item nzTitle="创建时间">2024-06-19 15:23:50</nz-descriptions-item>
    <nz-descriptions-item nzTitle="最后登录时间">2024-06-19 15:23:50</nz-descriptions-item>
    <nz-descriptions-item nzTitle="职位">财务总监</nz-descriptions-item>
    <nz-descriptions-item ></nz-descriptions-item>
    <nz-descriptions-item nzTitle="用户组" [nzSpan]="3">
      <nz-tag nzColor="cyan">超级管理员</nz-tag>
      <nz-tag nzColor="cyan">系统管理员</nz-tag>
    </nz-descriptions-item>
    <nz-descriptions-item nzTitle="角色" [nzSpan]="3">
      <nz-tag nzColor="blue">超级管理员</nz-tag>
      <nz-tag nzColor="blue">系统管理员</nz-tag>
      <nz-tag nzColor="geekblue" title="此角色来源于用户组"><iconify icon="mingcute:group-line" [size]="12"/>财务人员</nz-tag>
    </nz-descriptions-item>
  </nz-descriptions>
  <ng-template #back>
    <button nz-button nzDanger nzType="default" nzSize="small">启用</button>
    <button nz-button nzDanger nzType="default" nzSize="small">禁用</button>
  </ng-template>
</app-section>

<app-section dkTitle="拥有权限">
  <nz-table #menuPermissionTable
            [nzData]="rolePermissions"
            nzSize="small"
            nzTableLayout="fixed"
            nzBordered
            [nzLoading]="permissionTableLoading"
            [nzShowPagination]="false">
    <thead>
    <tr>
      <th nzWidth="300px">菜单名称</th>
      <th nzWidth="180px">类型</th>
      <th>权限</th>
    </tr>
    </thead>
    <tbody>
    <ng-container *ngFor="let data of menuPermissionTable.data">
      <ng-container *ngFor="let item of mapOfExpandedData[data.menuId]">
        <tr *ngIf="(item.parent && item.parent.expand) || !item.parent">
          <td
            [nzIndentSize]="item.level! * 20"
            [nzShowExpand]="!!item.children"
            [(nzExpand)]="item.expand"
            (nzExpandChange)="collapse(mapOfExpandedData[data.menuId], item, $event)"
          >
            <span nz-icon [nzType]="item.menuIcon" nzTheme="outline" *ngIf="item.menuIcon"></span>
            {{ item.menuName }}
          </td>
          <td>{{ item.menuType == 1 ? '菜单组' : '菜单项' }}</td>
          <td>
            @for (p of item.permissions; track p) {
              <nz-tag nzColor="processing"> {{ p.permissionName }}({{ p.permissionCode }})</nz-tag>
            }
          </td>
        </tr>
      </ng-container>
    </ng-container>
    </tbody>
  </nz-table>
</app-section>

<app-section dkTitle="登录记录">
  <nz-table #loginLogTable
            [nzFrontPagination]="false"
            nzTableLayout="fixed"
            nzShowPagination
            nzBordered
            nzSize="small"
            [nzTotal]="loginLogTableOptions.total"
            [(nzPageIndex)]="loginLogTableOptions.pageIndex"
            [(nzPageSize)]="loginLogTableOptions.pageSize"
            [nzLoading]="loginLogTableLoading"
            [nzData]="loginLogs"
            (nzPageSizeChange)="loadLoginLogs()"
            (nzPageIndexChange)="loadLoginLogs()">
    <thead>
    <tr>
      <th nzWidth="100px">平台</th>
      <th nzWidth="150px">登录方式</th>
      <th nzWidth="250px">登录时间</th>
      <th nzWidth="250px">登录IP</th>
      <th nzEllipsis>UserAgent</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let data of loginLogTable.data">
      <td>{{ data.platform }}</td>
      <td>{{ data.loginType }}</td>
      <td>{{ data.loginTime }}</td>
      <td>{{ data.loginIp }}</td>
      <td>{{ data.userAgent }}</td>
    </tr>
    </tbody>
  </nz-table>
</app-section>


